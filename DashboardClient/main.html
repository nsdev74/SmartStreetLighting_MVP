<!DOCTYPE html>
<html>
<head>
<meta charset=utf-8 />
<title>Plain Leaflet API</title>
<meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
<script src='https://api.mapbox.com/mapbox.js/v3.3.1/mapbox.js'></script>
<link href='https://api.mapbox.com/mapbox.js/v3.3.1/mapbox.css' rel='stylesheet' />
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
crossorigin=""/>
<style>
  body { margin:0%; padding:0; }
  #map { position:absolute; top:0; bottom:0; width:90%; margin:5% }
</style>
</head>
<body>

<div id='map'></div>

<script>
//Map setup
L.mapbox.accessToken = 'pk.eyJ1IjoibnNkZXY3NCIsImEiOiJja2prbGRnOXM1dHljMnpsZ2Y0eDBkMmtoIn0.DUlbCOHLAtfdU2wrVoN48w';
    
var mapboxTiles = L.tileLayer('https://api.mapbox.com/styles/v1/mapbox/streets-v11/tiles/{z}/{x}/{y}?access_token=' + L.mapbox.accessToken, {
       attribution: '© <a href="https://www.mapbox.com/feedback/">Mapbox</a> © <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',
       tileSize: 512,
       zoomOffset: -1
});
var map = L.map('map')
  .addLayer(mapboxTiles)
  .setView([34.033621, -6.813167], 13);

//Custom icons definition
    var brokenIcon = L.icon({
        iconUrl: 'icons/BrokenIcon.png',
        iconSize: [65, 65],
        iconAnchor: [22, 94],
        popupAnchor: [-3, -76]
    });

    var activeIcon = L.icon({
        iconUrl: 'icons/ActiveIcon.png',
        iconSize: [65, 65],
        iconAnchor: [22, 94],
        popupAnchor: [-3, -76]
    });

    var idleIcon = L.icon({
        iconUrl: 'icons/IdleIcon.png',
        iconSize: [65, 65],
        iconAnchor: [22, 94],
        popupAnchor: [-3, -76]
    });


// [2] = { Active, Frequence, Custom message } 
var mData = [
    [34.00, -6.79, "Active", 0],
    [34.02, -6.81, "Active", 1],
    [34.01, -6.82, "Active", 2],
    [34.01, -6.80, "Active", 0]
    ];

mData.forEach(element => 
    {
        switch(element[3])
        {
            case 0:
            L.marker([element[0], element[1]], {icon: brokenIcon}).addTo(map).bindPopup(element[2]).openPopup()
            break;
            case 1:
            L.marker([element[0], element[1]], {icon: idleIcon}).addTo(map).bindPopup(element[2]).openPopup()
            break;
            case 2:
            L.marker([element[0], element[1]], {icon: activeIcon}).addTo(map).bindPopup(element[2]).openPopup()
            break;
        }
        
    }
);





</script>

</body>
</html>

